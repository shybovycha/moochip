<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>Raphael :: Drag-n-drop</title>
        
		<script type="text/javascript" src="raphael.js"></script>
        
		<script type="text/javascript" src="moochip.js"></script>
		<script type="text/javascript" src="moochip-components-stdlib.js"></script>
		<script type="text/javascript" src="moochip-frontend-raphael.js"></script>
		
		<script type="text/javascript">
		var Cs = new Scheme();
		
		var a = new Component('dc_source', 'src1');
		a.pins.push(new Pin(a, 'positive'));
		a.pins.push(new Pin(a, 'negative'));
		a.pin('positive').i = 1;
		a.pin('positive').u = 5;
		Cs.add(a);
		
		var a = new Resistor('r1', 1);
		Cs.add(a);
		
		var a = new Diode('vd1');
		Cs.add(a);
		
		var a = new Wire('-1');
		Cs.add(a);
		
		var a = new Wire('-2');
		Cs.add(a);
		
		Cs.component('-1').connect(Cs.component('vd1').pin('cathode'));
		Cs.component('-2').connect(Cs.component('vd1').pin('anode'));
		
		Cs.component('-1').connect(Cs.component('src1').pin('positive'));
		Cs.component('-1').connect(Cs.component('r1').pin('a'));
		
		Cs.component('-2').connect(Cs.component('src1').pin('negative'));
		Cs.component('-2').connect(Cs.component('r1').pin('b'));
		
		Cs.run(Cs.component('src1'));
		</script>

        <script type="text/javascript">
            window.onload = function () {
				var cellSize = 25;
				
                var R = Raphael(0, 0, "100%", "100%"),
                    r = R.circle(100, 100, 50).attr({fill: "hsb(0, 1, 1)", stroke: "none", opacity: .5}); /*,
                    g = R.circle(210, 100, 50).attr({fill: "hsb(.3, 1, 1)", stroke: "none", opacity: .5}),
                    b = R.circle(320, 100, 50).attr({fill: "hsb(.6, 1, 1)", stroke: "none", opacity: .5}),
                    p = R.circle(430, 100, 50).attr({fill: "hsb(.8, 1, 1)", stroke: "none", opacity: .5});*/
					
                var start = function () {
                    this.ox = this.attr("cx");
                    this.oy = this.attr("cy");
                    //this.animate({r: 70, opacity: .25}, 500, ">");
                },
				
                move = function (dx, dy) {
					var x = Math.floor((this.ox + dx) / cellSize) * cellSize, y = Math.floor((this.oy + dy) / cellSize) * cellSize;
                    this.attr({cx: x, cy: y});
                },
				
                up = function () {
                    //this.animate({r: 50, opacity: .5}, 500, ">");
                };
				
                //R.set(r, g, b, p).drag(move, start, up);
				r.drag(move, start, up);
            };
        </script>
    </head>
	
    <body>
        <div id="holder"></div>
    </body>
</html>
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>moochip raphael demo</title>
        
		<script type="text/javascript" src="raphael.js"></script>
        
		<script type="text/javascript" src="moochip-raphael.js"></script>
		<script type="text/javascript" src="moochip-stdlib-raphael.js"></script>
		
		<script type="text/javascript">
		window.onload = function () {
			var R = Raphael('holder'); //0, 50, "100%", "80%");
			
			MooChip.paper = R;
			MooChip.scheme = new Scheme();
			
			/*var a = new DCSource('src1', 5.0);
			Cs.add(a);
			
			var a = new Resistor('r1', 1);
			Cs.add(a);
			
			var a = new Diode('vd1');
			Cs.add(a);
			
			var a = new Wire('-1');
			Cs.add(a);
			
			var a = new Wire('-2');
			Cs.add(a);*/
			
			/*Cs.component('-1').connect(Cs.component('vd1').pin('cathode'));
			Cs.component('-2').connect(Cs.component('vd1').pin('anode'));
			
			Cs.component('-1').connect(Cs.component('src1').pin('positive'));
			Cs.component('-1').connect(Cs.component('r1').pin('a'));
			
			Cs.component('-2').connect(Cs.component('src1').pin('negative'));
			Cs.component('-2').connect(Cs.component('r1').pin('b'));
			
			Cs.run(Cs.component('src1'));*/
		};
		
		function add(type) {
			var generateName = function(type) {
				var prefixes = { 'resistor': 'r', 'diode': 'vd', 'wire': '-', 'dc_source': 'src'}, components = MooChip.scheme.components, cnt = 1;
				
				for (var i = 0; i < components.length; i++) {
					if (components[i].type == type) {
						cnt++;
					}
				}
				
				return prefixes[type] + cnt;
			};
			
			if (type == 'resistor') {
				var a = new Resistor(generateName(type), 1.0);
				MooChip.scheme.add(a);
			} else
			if (type == 'diode') {
				var a = new Diode(generateName(type));
				MooChip.scheme.add(a);
			} else
			if (type == 'dc_source') {
				var a = new DCSource(generateName(type), 5.0, 1.0);
				MooChip.scheme.add(a);
			} else
			if (type == 'wire') {
				var a = new Wire(generateName(type));
				MooChip.scheme.add(a);
			}
		}
		
		function rotate_selected() {
			MooChip.scheme.selectedComponent.rotate(90);
		}
        </script>
    </head>
	
    <body>
		<div class="menu">
			<a href="#" onclick="add('resistor')">resistor</a>
			<a href="#" onclick="add('diode')">diode</a>
			<a href="#" onclick="add('dc_source')">DC source</a>
			<a href="#" onclick="add('wire')">wire</a>
			<a href="#" onclick="rotate_selected()">rotate selected</a>
		</div>
		
        <div id="holder"></div>
    </body>
</html>
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>moochip raphael demo</title>
        
        <%= javascript_include_tag 'raphael.js' %>
        <%= javascript_include_tag 'moochip-raphael.js' %>
        <%= javascript_include_tag 'moochip-stdlib-raphael.js' %>
				
		<script type="text/javascript">
		window.onload = function () {
			var R = Raphael('holder');
			
			MooChip.paper = R;
			MooChip.scheme = new Scheme();
		};
		
		function add(type) {
			var generateName = function(type) {
				var prefixes = { 'resistor': 'r', 'diode': 'vd', 'wire': '-', 'dc_source': 'src'}, components = MooChip.scheme.components, cnt = 1;
				
				for (var i = 0; i < components.length; i++) {
					if (components[i].type == type) {
						cnt++;
					}
				}
				
				return prefixes[type] + cnt;
			};
			
			if (type == 'resistor') {
				var a = new Resistor(generateName(type), 1.0);
				MooChip.scheme.add(a);
			} else
			if (type == 'diode') {
				var a = new Diode(generateName(type));
				MooChip.scheme.add(a);
			} else
			if (type == 'dc_source') {
				var a = new DCSource(generateName(type), 5.0, 1.0);
				MooChip.scheme.add(a);
			} else
			if (type == 'wire') {
				var a = new Wire(generateName(type));
				MooChip.scheme.add(a);
			}
		}
		
		function rotate_selected() {
			if (MooChip.scheme.selectedComponent)
				MooChip.scheme.selectedComponent.rotate(90);
		}
		
		function remove_selected() {
			if (MooChip.scheme.selectedComponent)
				MooChip.scheme.remove(MooChip.scheme.selectedComponent);
		}
        </script>
    </head>
	
    <body>
		<div class="menu">
			<a href="#" onclick="add('resistor')" title="create a new resistor">resistor</a>
			<a href="#" onclick="add('diode')" title="create a new diode">diode</a>
			<a href="#" onclick="add('dc_source')" title="create a new DC source">DC source</a>
			<a href="#" onclick="add('wire')" title="create a new wire">wire</a>
			&nbsp;|&nbsp;
			<a href="#" onclick="rotate_selected()" title="rotate selected component 90&deg; clockwise">rotate</a>
			<a href="#" onclick="remove_selected()" title="remove selected component">remove</a>
		</div>
		
        <div id="holder"></div>
    </body>
</html>